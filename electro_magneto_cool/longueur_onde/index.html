<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device_width, initial-scale=1.0">

  
  <title>👄↝🎤↝📈↝📡↝📡↝📈↝📻↝👂</title>
  <link rel="icon" type="image/png" href="img_4.png" />
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="style_menu.css"> 


</head>

<body id="body">

<div id="gauche" style="justify-content:center; display:grid" class="partie">
  

  <svg viewBox="0 0 600 400" id="waveSvg">
  <path id="sineWave" />
  <path id="horizontalWave" />
  <line x1="0" y1="290" x2="250" y2="290" />
  <line x1="250" y1="130" x2="250" y2="290" style="stroke-dasharray:5,5;"/>
  <line x1="0" y1="130" x2="0" y2="290" style="stroke-dasharray:5,5;"/>
  <rect id="antenna" width="3" height="250" x="600" y="120" style="fill: none; stroke: black; display: none;" />
</svg>
<div id="longueur_onde"><p> longueur d'onde </div>


<div id="info" style="display: grid; justify-content: center; margin-top: -220px;">
  <div class="sous_texte" style="width:500px;"><p>la longueur d'onde est la distance entre deux points identiques (comme deux crêtes) d'une onde périodique.</p></div>
  <button id="bouton_signal" style="" onclick='antenne()'>ajouter une antenne</button>

</div>





</div>

<rect class="d" x=".5" y=".5" width="3" height="115.92"/>




 </div>


<div id="controls" style="margin-top: 20px;">
  <label for="wavelengthSlider">Longueur d'onde : </label>
  <input type="range" id="wavelengthSlider" min="100" max="400" value="250" step="10">
  <span id="wavelengthValue">250</span> px
  <br>
  <small>Taille antenne : <span id="antennaSize">125</span> px (λ/2)</small>
</div>
<script type="text/javascript">

  ///////////////////////ANIM LONGUEUR D'ONDE//////////////////////////////////

const svgWidth = 600;
  const svgHeight = 400;
  const amplitude = 40;
  let wavelength = 250; // longueur d'onde en pixels
  const speed = 2; // pixels par frame (vitesse de décalage vers la droite)
  const step = 2; // pas horizontal entre points
  const frequency = 2 * Math.PI / wavelength;
  const pathElem = document.getElementById('sineWave');
  const horizontalPathElem = document.getElementById('horizontalWave');
  const antennaElem = document.getElementById('antenna');
  const antennaX = 600; // position X de l'antenne
  
  let phase = 0;
  let isHighlighted = false;
  let highlightTimeout = null;
  let isAnimating = false; // Variable pour contrôler l'animation
  let antennaVisible = false; // Variable pour savoir si l'antenne est visible
  let waveExtent = 250; // Nouvelle variable pour contrôler l'étendue de l'onde
  

  // Nouvelle fonction pour mettre à jour l'onde
function updateWave() {
  wavelength = parseInt(document.getElementById('wavelengthSlider').value);
  frequency = 2 * Math.PI / wavelength;
  
  // Mettre à jour l'affichage
  document.getElementById('wavelengthValue').textContent = wavelength;
  document.getElementById('antennaSize').textContent = Math.round(wavelength * antennaRatio);
  
  // Redimensionner l'antenne
  if (antennaVisible) {
    const newAntennaHeight = wavelength * antennaRatio;
    antennaElem.setAttribute('height', newAntennaHeight);
  }
  
  // Si l'animation n'est pas en cours, redessiner l'onde statique
  if (!isAnimating) {
    pathElem.setAttribute('d', generatePath(phase, Math.min(waveExtent, wavelength * 2)));
  }
}

// Event listener pour le slider
document.getElementById('wavelengthSlider').addEventListener('input', updateWave);


  function generatePath(phase, maxX) {
    let d = "";
    let started = false;
    // Utiliser waveExtent au lieu de maxX fixe
    const endX = maxX || waveExtent;
    
    for(let x = 0; x <= endX; x += step) {
      let y = svgHeight / 2 + amplitude * Math.sin(frequency * (x - phase));
      if (!started) {
        d += `M ${x} ${y}`;
        started = true;
      } else {
        d += ` L ${x} ${y}`;
      }
    }
    return d;
  }
  
  function checkWaveAtAntenna() {
    // Vérifier seulement si l'onde a atteint l'antenne
    if (waveExtent >= antennaX && antennaVisible) {
      // Calculer la valeur de la sinusoïde à la position de l'antenne
      const waveValueAtAntenna = Math.sin(frequency * (antennaX - phase));
      
      // Détecter si on est proche du maximum OU du minimum (avec une petite tolérance)
      if ((waveValueAtAntenna < -0.95) && !isHighlighted) {
        // Activer le surlignage
        antennaElem.classList.add('antenna-highlight');
        isHighlighted = true;
        
        // Programmer l'arrêt du surlignage après 500ms
        highlightTimeout = setTimeout(() => {
          antennaElem.classList.remove('antenna-highlight');
          isHighlighted = false;
        }, 500);
      }
    }
  }
  
  function animate() {
    if (isAnimating) {
      phase += speed;
      // Faire grandir l'onde progressivement jusqu'à l'antenne
      if (waveExtent < antennaX) { // +50 pour dépasser un peu l'antenne
        waveExtent += speed; // L'onde grandit à la même vitesse que la phase
      }
      pathElem.setAttribute('d', generatePath(phase));
      checkWaveAtAntenna();
    } else {
      // Onde statique au départ, limitée à 250px
      pathElem.setAttribute('d', generatePath(0, 250));
    }
    requestAnimationFrame(animate);
  }
  
  // Initialiser l'onde statique
  animate();







  ///////////////////////POSITION texte//////////////////////////////////

// Attendre que jQuery soit chargé
function initMouseMove() {
  if (typeof $ !== 'undefined') {
    $(function() {
      $('#body').mousemove(function(e) {
        var x = e.pageX;
        var y = e.pageY;
        var mid = $(window).height();
        var midW =$(window).width()/2;
        // var docHeight = $(document).height();

        $('.legende').css('top', y+50+'px');
        $('.legende').css('left', x-20+'px');
      });
    });
  } else {
    // Réessayer dans 100ms si jQuery n'est pas encore chargé
    setTimeout(initMouseMove, 100);
  }
}

// Lancer l'initialisation
initMouseMove();






////////////////////////APPARITION ET BOUTON////////////////////
function antenne(){
  if (!antennaVisible) {
    const antennaHeight = wavelength * antennaRatio;
    antennaElem.setAttribute('height', antennaHeight);
    $('#antenna').css('display','block');
    antennaVisible = true;
    document.querySelector('.sous_texte p').textContent = 
      "l'antenne mesure λ/2 pour entrer en résonance optimale avec l'onde";
    document.getElementById("bouton_signal").textContent = "lancer le signal";
  } else {
    // Deuxième clic : lancer le signal
    isAnimating = true;
    waveExtent = 250; // Réinitialiser l'étendue de l'onde au démarrage
    document.getElementById("bouton_signal").textContent = "signal lancé";
    document.getElementById("bouton_signal").disabled = true;
  }
}


function signal(){



}
</script>
</body>
  </html>